!function(t){function n(){function t(t,n){return i.push({event:t,fn:n}),o}function n(t,n){return i=i.filter(function(e){return!(e.event===t&&e.fn===n)}),o}function e(e,r){function i(){n(e,i),r.apply(o,arguments)}return t(e,i),o}function r(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return i.filter(function(n){return n.event===t}).forEach(function(t){t.fn.apply(o,n)}),o}var o,i=[];return o={emit:r,on:t,off:n,once:e}}var e=["alt","src","title","value","placeholder","label"],r=function(){function t(t,r){void 0===t&&(t="cn"),this._defaultLang=t,this._currentLang=t,this._attrs=r||e,this._i18ns={},this._emitter=n()}return t.prototype.i18n=function(t){var n=this;t&&Object.keys(t).forEach(function(e){n._i18ns[e]=t[e]})},t.prototype.on=function(t,n){return this._emitter.on(t,n),this},t.prototype.once=function(t,n){return this._emitter.once(t,n),this},t.prototype.off=function(t,n){return this._emitter.off(t,n),this},t.prototype.parse=function(t){var n,e={optionsLang:{},currentLang:null,currentText:null};if(t=String(t).replace(/<!--\{([\w-]+)\}-->([^]+?)<!--\/\{\1\}-->|<!--\{([\w-]+|\*)\}([^]+?)-->/g,function(t,r,o,i,a){return n=!0,r?(e.currentLang=r,e.currentText=o,e.optionsLang[r]=o):e.optionsLang[i]=a,""}),!n)return null;if(e.optionsLang["*"]){var r=this.parse(this._i18ns[e.optionsLang["*"]]);r&&(Object.keys(r.optionsLang).forEach(function(t){e.optionsLang[t]=r.optionsLang[t]}),e.currentLang=e.currentLang||r.currentLang,e.currentText=e.currentText||r.currentText)}return t=t.trim(),t&&(e.defaultText=t,e.optionsLang[this._defaultLang]||(e.optionsLang[this._defaultLang]=t)),e},t.prototype.build=function(t,n){var e="";if(Object.keys(n.optionsLang).forEach(function(r){var o=n.optionsLang[r];e+=r===t?"\x3c!--{"+r+"}--\x3e"+o+"\x3c!--/{"+r+"}--\x3e":"\x3c!--{"+r+"}"+o+"--\x3e"}),!n.optionsLang[t]){var r=this._defaultLang,o=n.optionsLang[this._defaultLang];e+="\x3c!--{"+r+"}--\x3e"+o+"\x3c!--/{"+r+"}--\x3e"}return e},t.prototype.update=function(t,n){var e=this;if(t=t||this._currentLang,this._currentLang!==t&&(this._currentLang=t,this._emitter.emit("change",t)),"undefined"!=typeof document){n?"string"==typeof n&&(n=document.querySelector(n)):n=document.documentElement;for(var r,o=document.createNodeIterator(n,NodeFilter.SHOW_COMMENT,null,!1),i=[],a=[];r=o.nextNode();)i.indexOf(r.parentNode)>=0||/^(script|style|link)$/i.test(r.parentNode.nodeName)||!/^\{[\w-]+\}/.test(r.nodeValue)||(i.push(r.parentNode),a.push(this.parse(r.parentNode.innerHTML)));i.forEach(function(n,r){a[r]&&(n.innerHTML=e.build(t,a[r]))}),this._attrs.forEach(function(r){var o="data-lang-"+r;[].slice.call(n.querySelectorAll("["+o+"]")).forEach(function(n){var i=n.getAttribute(o),a=e.parse(i);a&&(a.optionsLang[e._defaultLang]||(a.optionsLang[e._defaultLang]=n.getAttribute(r)),n.setAttribute(o,e.build(t,a)),n.setAttribute(r,a.optionsLang[t]||a.optionsLang[e._defaultLang]))})})}},t.prototype.get=function(t,n){n=n||this._currentLang;var e=this.parse(t);return e?e.optionsLang[n]||e.defaultText||e.optionsLang[this._defaultLang]:t},t}(),o={Languages:r};"function"==typeof define?(define.amd||define.cmd)&&define(function(){return o}):"undefined"!=typeof module&&module.exports?module.exports=o:window.h5i18n=o}();