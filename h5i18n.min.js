!function(t){function n(){function t(t,n){return i.push({event:t,fn:n}),r}function n(t,n){return i=i.filter(function(e){return!(e.event===t&&e.fn===n)}),r}function e(e,o){function i(){n(e,i),o.apply(r,arguments)}return t(e,i),r}function o(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return i.filter(function(n){return n.event===t}).forEach(function(t){t.fn.apply(r,n)}),r}var r,i=[];return r={emit:o,on:t,off:n,once:e}}var e=["alt","src","title","value","placeholder","label"],o=function(){function t(t,o){void 0===t&&(t="cn"),this._defaultLang=t,this._currentLang=t,this._attrs=o||e,this._i18ns={},this._emitter=n()}return t.prototype.i18n=function(t){var n=this;t&&Object.keys(t).forEach(function(e){n._i18ns[e]=t[e]})},t.prototype.on=function(t,n){return this._emitter.on(t,n),this},t.prototype.once=function(t,n){return this._emitter.once(t,n),this},t.prototype.off=function(t,n){return this._emitter.off(t,n),this},t.prototype.parse=function(t){var n,e={optionsLang:{},currentLang:null,currentText:null};if(t=String(t).replace(/<!--\{([\w-]+)\}-->([^]*?)<!--\/\{\1\}-->|<!--\{([\w-]+|\*)\}([^]*?)-->/g,function(t,o,r,i,a){return n=!0,o?(e.currentLang=o,e.currentText=r,e.optionsLang[o]=r):e.optionsLang[i]=a,""}),!n)return null;if(e.optionsLang["*"]){var o=this.parse(this._i18ns[e.optionsLang["*"]]);o&&(Object.keys(o.optionsLang).forEach(function(t){e.optionsLang[t]=o.optionsLang[t]}),e.currentLang=e.currentLang||o.currentLang,e.currentText=e.currentText||o.currentText)}return t=t.trim(),t&&(e.defaultText=t,e.optionsLang[this._defaultLang]||(e.optionsLang[this._defaultLang]=t)),e},t.prototype.build=function(t,n){var e="";if(Object.keys(n.optionsLang).forEach(function(o){var r=n.optionsLang[o];e+=o===t?"\x3c!--{"+o+"}--\x3e"+r+"\x3c!--/{"+o+"}--\x3e":"\x3c!--{"+o+"}"+r+"--\x3e"}),!n.optionsLang[t]){var o=this._defaultLang,r=n.optionsLang[this._defaultLang]||"";e+="\x3c!--{"+o+"}--\x3e"+r+"\x3c!--/{"+o+"}--\x3e"}return e},t.prototype.update=function(t,n){var e=this;if(t=t||this._currentLang,this._currentLang!==t&&(this._currentLang=t,this._emitter.emit("change",t)),"undefined"!=typeof document){n?"string"==typeof n&&(n=document.querySelector(n)):n=document.documentElement;for(var o,r=document.createNodeIterator(n,NodeFilter.SHOW_COMMENT,null,!1),i=[],a=[];o=r.nextNode();)i.indexOf(o.parentNode)>=0||/^(script|style|link)$/i.test(o.parentNode.nodeName)||!/^\{[\w-]+\}/.test(o.nodeValue)||(i.push(o.parentNode),a.push(this.parse(o.parentNode.innerHTML)));i.forEach(function(n,o){n.innerHTML=e.build(t,a[o])}),this._attrs.forEach(function(o){var r="data-lang-"+o;[].slice.call(n.querySelectorAll("["+r+"]")).forEach(function(n){var i=n.getAttribute(r),a=e.parse(i);a&&(a.optionsLang[e._defaultLang]||(a.optionsLang[e._defaultLang]=n.getAttribute(o)),n.setAttribute(r,e.build(t,a)),n.setAttribute(o,a.optionsLang[t]||a.optionsLang[e._defaultLang]))})})}},t.prototype.get=function(t,n){n=n||this._currentLang;var e=this.parse(t);return e?void 0!==e.optionsLang[n]?e.optionsLang[n]:void 0!==e.defaultText?e.defaultText:e.optionsLang[this._defaultLang]:t},t}(),r={Languages:o};"function"==typeof define?(define.amd||define.cmd)&&define(function(){return r}):"undefined"!=typeof module&&module.exports?module.exports=r:window.h5i18n=r}();